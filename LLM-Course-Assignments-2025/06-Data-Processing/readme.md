【代码仓库链接】
https://github.com/zgz-zhougz/Data-Processing-sz2507093-.git
这是一个由大模型驱动的QAR（Quick Access Recorder）数据分析代理系统，实现了从CSV输入到分析报告的全流程自动化。
## 🏗️ 核心架构
### 1. __三层架构设计__
- __Agent层__ (`agent.py`): 基于LangGraph的工作流编排
- __Tools层__ (`tools.py`): 数据处理、清洗、分析、可视化工具集
- __App层__ (`app.py`): Streamlit交互界面
### 2. __LangGraph工作流__
数据输入 → 数据清洗 → EDA分析 → 可视化 → 统计检验 → 报告生成
## 🎯 主要创新点
### 1. __全流程自动化__
- ✅ CSV输入 → analysis.json → report.md → report.pdf
- ✅ 统一数据结构承载所有分析结果
- ✅ 支持大文件分块处理（200-300MB+）
### 2. __QAR数据智能处理__
- ✅ __字段映射__: 自动识别QAR缩写字段名
- ✅ __飞行阶段映射__: 数字阶段 → 可读名称（起飞/巡航/进近等）
- ✅ __行业阈值__: 发动机/飞行参数的民航标准范围
### 3. __双重筛选机制__
- ✅ __参数筛选__: 按类型自动/手动筛选（发动机/飞行/系统参数）
- ✅ __飞行阶段筛选__: 按阶段筛选减少数据量
- ✅ __Token验证__: 实时估算和验证token消耗
### 4. __统计检验优化__
- ✅ __Pearson相关性__: 识别参数间关联
- ✅ __ANOVA检验__: 飞行阶段间参数差异
- ✅ __卡方检验__: 分类变量关联性
- ✅ __列对过滤__: 避免无效组合，提升效率
## 🔧 技术亮点
### 数据清洗 (`tools.py` - clean_data)
# 1. 飞行阶段过滤 - 保留有效阶段
valid_phases = ["起飞Takeoff", "巡航CRZ", "进近APP", ...]
# 2. 重复值处理 - 时间戳+关键参数联合去重
dup_cols = [timestamp, engine_params...]
# 3. 缺失值处理 - 区分关键/非关键参数
#    - 发动机参数: 滑动平均填充
#    - 分类变量: 众数填充
#    - 数值变量: 中位数填充
# 4. 异常值处理 - 行业阈值替换
engine_thresholds = {"n1_speed": (20.0, 100.0), ...}
## 📊 报告生成逻辑
### Prompt设计 (`agent.py` - report_node)
1. 数据概述（QAR数据基本信息+清洗过程）
   - 突出飞行阶段过滤
   - 行业阈值应用
2. 飞行参数分析
   - 关键参数时间序列趋势
   - 不同飞行阶段的参数分布差异
3. 统计检验结果
   - 发动机参数与飞行参数的关联性
   - 飞行阶段间参数差异的显著性
4. 核心洞见
   - 合规性评估
   - 发动机健康状态
   - 飞行操作优化点
5. 建议措施
   - 具体可执行动作
## 🎨 交互界面功能
### Streamlit App (`app.py`)
- __数据上传__: CSV/BIN格式支持
- __字段映射配置__: 用户自定义字段名
- __参数筛选__: 自动推荐/手动选择/保留全部
- __飞行阶段筛选__: 多阶段选择
- __Token验证__: 实时显示安全状态
- __可视化展示__: 图表自动展示
- __报告下载__: Markdown格式导出
## 🚀 后续迭代方向
### 1. __LangGraph节点化__
- 将流程拆分为独立节点
- 支持条件分支和循环
- 增强错误处理和重试机制
### 2. __LLM集成__
- __洞见扩写__: 基于统计结果生成详细解释
- __结果解释__: 用自然语言解释复杂统计
- __自检/反思__: LLM验证结果合理性
### 3. __功能增强__
- PDF报告生成
- 实时数据流处理
- 多数据源支持
- 预警规则引擎
